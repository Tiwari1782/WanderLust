<% layout("/layouts/boilerplate") %>

<!-- Success Toast Notification -->
<% if (success && success.length) { %>
  <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;">
    <div class="toast-card success" role="alert">
      <svg class="wave" viewBox="0 0 1440 320" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M0,256L11.4,240C22.9,224,46,192,69,192C91.4,192,114,224,137,234.7C160,245,183,235,206,213.3C228.6,192,251,160,274,149.3C297.1,139,320,149,343,181.3C365.7,213,389,267,411,282.7C434.3,299,457,277,480,250.7C502.9,224,526,192,549,181.3C571.4,171,594,181,617,208C640,235,663,277,686,256C708.6,235,731,149,754,122.7C777.1,96,800,128,823,165.3C845.7,203,869,245,891,224C914.3,203,937,117,960,112C982.9,107,1006,181,1029,197.3C1051.4,213,1074,171,1097,144C1120,117,1143,107,1166,133.3C1188.6,160,1211,224,1234,218.7C1257.1,213,1280,139,1303,133.3C1325.7,128,1349,192,1371,192C1394.3,192,1417,128,1429,96L1440,64L1440,320L1428.6,320C1417.1,320,1394,320,1371,320C1348.6,320,1326,320,1303,320C1280,320,1257,320,1234,320C1211.4,320,1189,320,1166,320C1142.9,320,1120,320,1097,320C1074.3,320,1051,320,1029,320C1005.7,320,983,320,960,320C937.1,320,914,320,891,320C868.6,320,846,320,823,320C800,320,777,320,754,320C731.4,320,709,320,686,320C662.9,320,640,320,617,320C594.3,320,571,320,549,320C525.7,320,503,320,480,320C457.1,320,434,320,411,320C388.6,320,366,320,343,320C320,320,297,320,274,320C251.4,320,229,320,206,320C182.9,320,160,320,137,320C114.3,320,91,320,69,320C45.7,320,23,320,11,320L0,320Z"
          fill-opacity="1"
        ></path>
      </svg>

      <div class="icon-container">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon">
          <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
        </svg>
      </div>

      <div class="message-text-container">
        <p class="message-text">Success!</p>
        <p class="sub-text"><%= success[0] %></p>
      </div>

      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 15 15"
        fill="currentColor"
        class="cross-icon"
        onclick="this.closest('.toast-card').style.display='none'"
      >
        <path
          d="M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z"
          clip-rule="evenodd"
          fill-rule="evenodd"
        ></path>
      </svg>
    </div>
  </div>
<% } %>

<!-- Error Toast Notification -->
<% if (error && error.length) { %>
  <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;">
    <div class="toast-card error" role="alert">
      <svg class="wave" viewBox="0 0 1440 320" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M0,256L11.4,240C22.9,224,46,192,69,192C91.4,192,114,224,137,234.7C160,245,183,235,206,213.3C228.6,192,251,160,274,149.3C297.1,139,320,149,343,181.3C365.7,213,389,267,411,282.7C434.3,299,457,277,480,250.7C502.9,224,526,192,549,181.3C571.4,171,594,181,617,208C640,235,663,277,686,256C708.6,235,731,149,754,122.7C777.1,96,800,128,823,165.3C845.7,203,869,245,891,224C914.3,203,937,117,960,112C982.9,107,1006,181,1029,197.3C1051.4,213,1074,171,1097,144C1120,117,1143,107,1166,133.3C1188.6,160,1211,224,1234,218.7C1257.1,213,1280,139,1303,133.3C1325.7,128,1349,192,1371,192C1394.3,192,1417,128,1429,96L1440,64L1440,320L1428.6,320C1417.1,320,1394,320,1371,320C1348.6,320,1326,320,1303,320C1280,320,1257,320,1234,320C1211.4,320,1189,320,1166,320C1142.9,320,1120,320,1097,320C1074.3,320,1051,320,1029,320C1005.7,320,983,320,960,320C937.1,320,914,320,891,320C868.6,320,846,320,823,320C800,320,777,320,754,320C731.4,320,709,320,686,320C662.9,320,640,320,617,320C594.3,320,571,320,549,320C525.7,320,503,320,480,320C457.1,320,434,320,411,320C388.6,320,366,320,343,320C320,320,297,320,274,320C251.4,320,229,320,206,320C182.9,320,160,320,137,320C114.3,320,91,320,69,320C45.7,320,23,320,11,320L0,320Z"
          fill-opacity="1"
        ></path>
      </svg>

      <div class="icon-container">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon">
          <path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
        </svg>
      </div>

      <div class="message-text-container">
        <p class="message-text">Error!</p>
        <p class="sub-text"><%= error[0] %></p>
      </div>

      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 15 15"
        fill="currentColor"
        class="cross-icon"
        onclick="this.closest('.toast-card').style.display='none'"
      >
        <path
          d="M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z"
          clip-rule="evenodd"
          fill-rule="evenodd"
        ></path>
      </svg>
    </div>
  </div>
<% } %>

<!-- Auth Container -->
<div class="auth-wrapper">
  <div class="auth-container" id="authContainer">
    <!-- Login Form -->
    <div class="form-box login">
      <form action="/login" method="post" novalidate class="needs-validation">
        <h1><i class="fas fa-sign-in-alt"></i> Login</h1>
        
        <div class="input-box">
          <input type="text" name="username" placeholder="Username" required />
          <i class="fas fa-user"></i>
        </div>

        <div class="input-box">
          <input type="password" name="password" placeholder="Password" required />
          <i class="fas fa-lock"></i>
        </div>

        <div class="forgot-link">
          <a href="#"><i class="fas fa-question-circle"></i> Forgot Password?</a>
        </div>

        <button type="submit" class="btn-auth">
          <i class="fas fa-sign-in-alt"></i> Login
        </button>

        <p class="social-text">or login with social platforms</p>
        <div class="social-icons">
          <a href="#"><i class="fab fa-google"></i></a>
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-github"></i></a>
          <a href="#"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </form>
    </div>

    <!-- Signup Form -->
    <div class="form-box register">
      <form action="/signup" method="post" novalidate class="needs-validation">
        <h1><i class="fas fa-user-plus"></i> Sign Up</h1>
        
        <div class="input-box">
          <input type="text" name="username" placeholder="Username" required />
          <i class="fas fa-user"></i>
        </div>

        <div class="input-box">
          <input type="email" name="email" placeholder="Email Address" required />
          <i class="fas fa-envelope"></i>
        </div>

        <div class="input-box">
          <input type="password" name="password" placeholder="Password" required />
          <i class="fas fa-lock"></i>
        </div>

        <button type="submit" class="btn-auth">
          <i class="fas fa-user-plus"></i> Create Account
        </button>

        <p class="social-text">or register with social platforms</p>
        <div class="social-icons">
          <a href="#"><i class="fab fa-google"></i></a>
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-github"></i></a>
          <a href="#"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </form>
    </div>

    <!-- Toggle Panel -->
    <div class="toggle-box">
      <div class="toggle-panel toggle-left">
        <h1>Hello, Welcome!</h1>
        <p>Don't have an account?</p>
        <button class="btn-toggle register-btn" type="button">
          <i class="fas fa-user-plus"></i> Signup
        </button>
      </div>

      <div class="toggle-panel toggle-right">
        <h1>Welcome Back!</h1>
        <p>Already have an account?</p>
        <button class="btn-toggle login-btn" type="button">
          <i class="fas fa-sign-in-alt"></i>Login
        </button>
      </div>
    </div>
  </div>
</div>
<style>
  /* ============================================
   Authentication Pages (Signup/Login)
   ============================================ */
/* Auth Wrapper */
.auth-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: calc(100vh - 100px);
  padding: 20px;
}

.back-link {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: #fe424d;
  text-decoration: none;
  font-weight: 500;
  font-size: 16px;
  transition: all 0.3s ease;
}

.back-link:hover {
  color: #d63540;
  gap: 12px;
}

/* Auth Container */
.auth-container {
  position: relative;
  width: 100%;
  max-width: 850px;
  height: 550px;
  background: #fff;
  border-radius: 30px;
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.15);
  overflow: hidden;
}

.auth-container h1 {
  font-size: 36px;
  margin: -10px 0 20px;
  color: #222;
  font-weight: 600;
}

.auth-container h1 i {
  margin-right: 10px;
  color: #fe424d;
}

.auth-container p {
  font-size: 14.5px;
  margin: 15px 0;
  color: #666;
}

/* Form Box */
.form-box {
  position: absolute;
  right: 0;
  width: 50%;
  height: 100%;
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #333;
  text-align: center;
  padding: 40px;
  z-index: 1;
  transition:
    right 0.6s ease-in-out 1.2s,
    visibility 0s 1s;
}

.auth-container.active .form-box {
  right: 50%;
}

.form-box.register {
  visibility: hidden;
}

.auth-container.active .form-box.register {
  visibility: visible;
}

.form-box form {
  width: 100%;
}

/* Input Box */
.input-box {
  position: relative;
  margin: 25px 0;
}

.input-box input {
  width: 100%;
  padding: 13px 50px 13px 20px;
  background: #f5f5f5;
  border-radius: 10px;
  border: 2px solid transparent;
  outline: none;
  font-size: 16px;
  color: #333;
  font-weight: 500;
  transition: all 0.3s ease;
}

.input-box input:focus {
  background: #fff;
  border-color: #fe424d;
}

.input-box input::placeholder {
  color: #999;
  font-weight: 400;
}

.input-box i {
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 18px;
  color: #fe424d;
}

/* Forgot Link */
.forgot-link {
  margin: -15px 0 20px;
  text-align: left;
}

.forgot-link a {
  font-size: 14px;
  color: #666;
  text-decoration: none;
  transition: color 0.3s ease;
}

.forgot-link a:hover {
  color: #fe424d;
}

.forgot-link a i {
  margin-right: 5px;
}

/* Buttons */
.btn-auth {
  width: 100%;
  height: 48px;
  background: linear-gradient(135deg, #fe424d 0%, #ff6b6b 100%);
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(254, 66, 77, 0.3);
  border: none;
  cursor: pointer;
  font-size: 16px;
  color: #fff;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-auth:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(254, 66, 77, 0.4);
}

.btn-auth i {
  margin-right: 8px;
}

/* Social Icons */
.social-text {
  margin: 20px 0 15px;
  color: #999;
  font-size: 13px;
}

.social-icons {
  display: flex;
  justify-content: center;
  gap: 12px;
}

.social-icons a {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 42px;
  height: 42px;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 18px;
  color: #666;
  transition: all 0.3s ease;
}

.social-icons a:hover {
  border-color: #fe424d;
  color: #fe424d;
  transform: translateY(-3px);
  box-shadow: 0 4px 12px rgba(254, 66, 77, 0.2);
}

/* Toggle Box */
.toggle-box {
  position: absolute;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.toggle-box::before {
  content: "";
  position: absolute;
  left: -250%;
  width: 300%;
  height: 100%;
  background: linear-gradient(135deg, #fe424d 0%, #ff6b6b 100%);
  border-radius: 150px;
  z-index: 2;
  transition: 1.8s ease-in-out;
  pointer-events: all;
}

.auth-container.active .toggle-box::before {
  left: 50%;
}

.toggle-panel {
  position: absolute;
  width: 50%;
  height: 100%;
  color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 40px;
  z-index: 3;
  transition: 0.6s ease-in-out;
  pointer-events: all;
}

.toggle-panel h1 {
  color: #fff;
  font-size: 32px;
  margin-bottom: 15px;
}

.toggle-panel p {
  color: rgba(255, 255, 255, 0.9);
  margin-bottom: 25px;
  font-size: 15px;
}

.toggle-panel.toggle-left {
  left: 0;
  transition-delay: 1.2s;
}

.auth-container.active .toggle-panel.toggle-left {
  left: -50%;
  transition-delay: 0.6s;
}

.toggle-panel.toggle-right {
  right: -50%;
  transition-delay: 0.6s;
}

.auth-container.active .toggle-panel.toggle-right {
  right: 0;
  transition-delay: 1.2s;
}

.btn-toggle {
  width: 160px;
  height: 46px;
  background: transparent;
  border: 2px solid #fff;
  border-radius: 10px;
  color: #fff;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.btn-toggle:hover {
  background: #fff;
  color: #fe424d;
}

.btn-toggle i {
  margin-right: 8px;
}

/* Responsive Design */
@media screen and (max-width: 900px) {
  .auth-container {
    max-width: 100%;
    height: auto;
    min-height: 600px;
  }
}

@media screen and (max-width: 768px) {
  .auth-container {
    height: calc(100vh - 100px);
    min-height: 550px;
  }

  .form-box {
    bottom: 0;
    width: 100%;
    height: 65%;
    padding: 30px;
  }

  .auth-container.active .form-box {
    right: 0;
    bottom: 35%;
  }

  .toggle-box::before {
    left: 0;
    top: -270%;
    width: 100%;
    height: 300%;
    border-radius: 20vw;
  }

  .auth-container.active .toggle-box::before {
    left: 0;
    top: 65%;
  }

  .toggle-panel {
    width: 100%;
    height: 35%;
  }

  .toggle-panel.toggle-left {
    top: 0;
    left: 0;
  }

  .auth-container.active .toggle-panel.toggle-left {
    left: 0;
    top: -35%;
  }

  .toggle-panel.toggle-right {
    right: 0;
    bottom: -35%;
  }

  .auth-container.active .toggle-panel.toggle-right {
    bottom: 0;
  }

  .auth-container h1 {
    font-size: 28px;
  }

  .toggle-panel h1 {
    font-size: 26px;
  }
}

@media screen and (max-width: 400px) {
  .form-box {
    padding: 20px;
  }

  .auth-container h1 {
    font-size: 24px;
  }

  .toggle-panel h1 {
    font-size: 22px;
  }

  .input-box {
    margin: 20px 0;
  }

  .btn-toggle {
    width: 140px;
    height: 42px;
    font-size: 14px;
  }
}
</style>
<script>
  // Get the current URL path
  const currentPath = window.location.pathname;
  const container = document.querySelector('.auth-container');
  const registerBtn = document.querySelector('.register-btn');
  const loginBtn = document.querySelector('.login-btn');

  // Set initial state based on URL
  if (currentPath === '/signup') {
    container.classList.add('active');
  }

  // Toggle to signup and change URL
  registerBtn.addEventListener('click', () => {
    container.classList.add('active');
    // Change URL without page reload
    window.history.pushState({}, '', '/signup');
  });

  // Toggle to login and change URL
  loginBtn.addEventListener('click', () => {
    container.classList.remove('active');
    // Change URL without page reload
    window.history.pushState({}, '', '/login');
  });

  // Handle browser back/forward buttons
  window.addEventListener('popstate', () => {
    const path = window.location.pathname;
    if (path === '/signup') {
      container.classList.add('active');
    } else if (path === '/login') {
      container.classList.remove('active');
    }
  });

  // Auto-hide toasts after 5 seconds
  document.addEventListener('DOMContentLoaded', function() {
    const toasts = document.querySelectorAll('.toast-card');
    toasts.forEach(toast => {
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        toast.style.transition = 'all 0.4s ease-out';
        setTimeout(() => {
          toast.style.display = 'none';
        }, 400);
      }, 5000);
    });
  });
</script>