<nav class="navbar navbar-expand-lg border-bottom sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="/listings">
      <i class="fa-regular fa-compass"></i>
    </a>

    <!-- Airbnb Segmented Search Bar - Mobile -->
    <div class="airbnb-search-mobile d-lg-none">
      <button class="airbnb-search-btn-mobile" onclick="openSearchModal()">
        <div class="search-btn-content">
          <i class="fas fa-search"></i>
          <div class="search-btn-text">
            <span class="search-label">Anywhere</span>
          </div>
        </div>
        <div class="filter-icon-mobile">
          <i class="fas fa-sliders"></i>
        </div>
      </button>
    </div>

    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <!-- Left side navigation -->
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" href="/listings"><i class="fa-solid fa-signs-post"></i> Explore</a>
        </li>
      </ul>

      <!-- Airbnb Segmented Search Bar - Desktop -->
      <div class="airbnb-search-desktop d-none d-lg-block">
        <form action="/listings/search" method="GET" class="airbnb-search-form">
          <div class="airbnb-search-segmented">
            <div class="search-segment search-where">
              <label>Anywhere</label>
              <input
                type="text"
                name="q"
                placeholder="Search destination"
                autocomplete="off"
                required
              />
            </div>
            <div class="search-divider"></div>
            <div class="search-segment search-when">
              <label>Any week</label>
            </div>
            <div class="search-divider"></div>
            <div class="search-segment search-guests">
              <span class="guests-text">Add guests</span>
              <button type="submit" class="search-button">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
        </form>
      </div>

      <!-- Right side navigation -->
      <ul class="navbar-nav ms-auto align-items-lg-center">
        <li class="nav-item">
          <a class="nav-link" href="/listings/new">
            <i class="fa-solid fa-circle-plus"></i> Airbnb your home
          </a>
        </li>
        <% if(!currUser) { %>
          <li class="nav-item">
            <a class="nav-link" href="/signup">
              <i class="fas fa-user-plus"></i> <b>Signup</b>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/login">
              <i class="fas fa-sign-in-alt"></i> <b>Login</b>
            </a>
          </li>
        <% } else { %>
          <li class="nav-item">
            <a class="nav-link" href="#" onclick="openLogoutModal(); return false;">
              <i class="fas fa-sign-out-alt"></i> <b>Logout</b>
            </a>
          </li>
        <% } %>

        <!-- Dark mode toggle -->
        <li class="nav-item ms-lg-2 mt-2 mt-lg-0">
          <button class="btn btn-delete" type="button" onclick="toggleTheme()" id="themeToggleBtn">
            <i class="fa-solid fa-moon"></i>
            <span class="d-inline d-lg-none">Toggle theme</span>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Mobile Search Modal -->
<div class="search-modal" id="searchModal">
  <div class="search-modal-overlay" onclick="closeSearchModal()"></div>
  <div class="search-modal-content">
    <div class="search-modal-header">
      <button class="search-modal-close" onclick="closeSearchModal()">
        <i class="fas fa-times"></i>
      </button>
      <h3>Search destinations</h3>
    </div>
    <form action="/listings/search" method="GET" class="search-modal-form">
      <div class="search-modal-body">
        <div class="search-input-group">
          <i class="fas fa-search"></i>
          <input
            type="text"
            name="q"
            placeholder="Where are you going?"
            autocomplete="off"
            required
            id="mobileSearchInput"
          />
        </div>
      </div>
      <div class="search-modal-footer">
        <button type="button" class="btn-clear" onclick="clearSearch()">Clear</button>
        <button type="submit" class="btn-search">
          <i class="fas fa-search"></i> Search
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Logout Confirmation Modal -->
<div class="delete-modal" id="logoutModal">
  <div class="delete-modal-overlay" onclick="closeLogoutModal()"></div>
  <div class="delete-modal-content">
    <div class="delete-modal-header">
      <div
        class="delete-modal-icon"
        style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);"
      >
        <i class="fas fa-sign-out-alt"></i>
      </div>
      <h3 class="delete-modal-title">Logout?</h3>
      <p class="delete-modal-subtitle">Are you sure you want to logout from your account?</p>
    </div>
    <div class="delete-modal-body">
      <p class="delete-modal-warning" style="background-color: #fff8f0; border-left-color: #ff9800;">
        <i class="fas fa-info-circle" style="color: #ff9800;"></i>
        You will need to login again to access your account.
      </p>
    </div>
    <div class="delete-modal-footer">
      <button type="button" class="btn-modal-cancel" onclick="closeLogoutModal()">
        <i class="fas fa-times"></i>
        Cancel
      </button>
      <a
        href="/logout"
        class="btn-modal-delete"
        style="text-decoration: none; background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); border-color: #ff9800;"
      >
        <i class="fas fa-sign-out-alt"></i>
        Yes, Logout
      </a>
    </div>
  </div>
</div>

<style>


/* ============================================
   Dark Mode Support
   ============================================ */
html[data-theme="dark"] .airbnb-search-segmented,
html[data-theme="dark"] .airbnb-search-btn-mobile {
  background-color: var(--surface-2);
  border-color: var(--border);
}

html[data-theme="dark"] .airbnb-search-segmented:hover,
html[data-theme="dark"] .airbnb-search-btn-mobile:hover {
  background-color: var(--surface);
}

html[data-theme="dark"] .search-segment:hover {
  background-color: var(--surface);
}

html[data-theme="dark"] .search-segment label {
  color: var(--text);
}

html[data-theme="dark"] .search-segment input,
html[data-theme="dark"] .guests-text {
  color: var(--text-soft);
}

html[data-theme="dark"] .search-segment input::placeholder {
  color: var(--text-soft);
}

html[data-theme="dark"] .search-divider {
  background-color: var(--border);
}

html[data-theme="dark"] .search-btn-content i,
html[data-theme="dark"] .search-label {
  color: var(--text);
}

html[data-theme="dark"] .filter-icon-mobile {
  border-color: var(--border);
}

html[data-theme="dark"] .filter-icon-mobile i {
  color: var(--text);
}

html[data-theme="dark"] .search-modal-content {
  background-color: var(--surface);
}

html[data-theme="dark"] .search-modal-header {
  border-bottom-color: var(--border);
}

html[data-theme="dark"] .search-modal-header h3,
html[data-theme="dark"] .search-modal-close i {
  color: var(--text);
}

html[data-theme="dark"] .search-input-group {
  background-color: var(--surface-2);
  border-color: var(--border);
}

html[data-theme="dark"] .search-input-group:focus-within {
  background-color: var(--surface);
  border-color: var(--text-soft);
}

html[data-theme="dark"] .search-input-group input {
  color: var(--text);
}

html[data-theme="dark"] .search-input-group input::placeholder,
html[data-theme="dark"] .search-input-group i {
  color: var(--text-soft);
}

html[data-theme="dark"] .search-modal-footer {
  background-color: var(--surface);
  border-top-color: var(--border);
}

html[data-theme="dark"] .btn-clear {
  color: var(--text);
}

html[data-theme="dark"] .delete-modal-content {
  background-color: var(--surface);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
}

html[data-theme="dark"] .delete-modal-title {
  color: var(--text);
}

html[data-theme="dark"] .delete-modal-subtitle,
html[data-theme="dark"] .delete-modal-warning {
  color: var(--text-muted);
}

html[data-theme="dark"] .btn-modal-cancel {
  background-color: var(--surface-2);
  color: var(--text);
  border-color: var(--border);
}
</style>

<script>
  // Search Modal Functions
  function openSearchModal() {
    document.getElementById('searchModal').classList.add('active');
    document.body.style.overflow = 'hidden';
    setTimeout(() => {
      document.getElementById('mobileSearchInput').focus();
    }, 100);
  }

  function closeSearchModal() {
    document.getElementById('searchModal').classList.remove('active');
    document.body.style.overflow = 'auto';
  }

  function clearSearch() {
    document.getElementById('mobileSearchInput').value = '';
    document.getElementById('mobileSearchInput').focus();
  }

  // Logout Modal Functions
  function openLogoutModal() {
    document.getElementById('logoutModal').classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeLogoutModal() {
    document.getElementById('logoutModal').classList.remove('active');
    document.body.style.overflow = 'auto';
  }

  // Close modals on Escape key
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      closeLogoutModal();
      closeSearchModal();
    }
  });
</script>